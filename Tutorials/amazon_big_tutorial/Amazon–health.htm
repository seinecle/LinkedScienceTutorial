<!DOCTYPE html>
<!-- saved from url=(0051)http://linkedscience.org/?page_id=1256&preview=true -->
<html dir="ltr" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>Amazon – health data  | LinkedScience.org</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="./Amazon–health_files/style.css">
<link rel="pingback" href="http://linkedscience.org/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="LinkedScience.org » Feed" href="http://linkedscience.org/feed/">
<link rel="alternate" type="application/rss+xml" title="LinkedScience.org » Comments Feed" href="http://linkedscience.org/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="LinkedScience.org » Amazon – health data Comments Feed" href="http://linkedscience.org/?page_id=1256/feed/">
<link rel="stylesheet" id="admin-bar-css" href="./Amazon–health_files/admin-bar.css" type="text/css" media="all">
<script type="text/javascript" async="" src="./Amazon–health_files/ga.js"></script><script type="text/javascript" src="./Amazon–health_files/comment-reply.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://linkedscience.org/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://linkedscience.org/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Linked Data for eScience Services (LIFE) project: 2 positions" href="http://linkedscience.org/jobs/linked-data-for-escience-services-life-project-2-positions/">
<meta name="generator" content="WordPress 3.3">
<link rel="canonical" href="http://linkedscience.org/?page_id=1256">
<style type="text/css" media="print">#wpadminbar { display:none; }</style>
<style type="text/css" media="screen">
	html { margin-top: 28px !important; }
	* html body { margin-top: 28px !important; }
</style>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-8367411-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link href="./Amazon–health_files/widget.css" rel="stylesheet" type="text/css"><style type="text/css">#twtr-widget-1 .twtr-avatar { display: none; } #twtr-widget-1 .twtr-tweet-text { margin-left: 0; }</style><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/document_iterator.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/find_proxy.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/get_html_text.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/global_constants.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/name_injection_builder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/number_injection_builder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/string_finder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/change_sink.js"></script><meta name="document_iterator.js"><meta name="find_proxy.js"><meta name="get_html_text.js"><meta name="global_constants.js"><meta name="name_injection_builder.js"><meta name="number_injection_builder.js"><meta name="string_finder.js"><meta name="change_sink.js"><style type="text/css">#twtr-widget-1 .twtr-doc,                      #twtr-widget-1 .twtr-hd a,                      #twtr-widget-1 h3,                      #twtr-widget-1 h4 {            background-color: #1F0C0C !important;            color: #FFFFFF !important;          }          #twtr-widget-1 .twtr-tweet a {            color: #316329 !important;          }          #twtr-widget-1 .twtr-bd, #twtr-widget-1 .twtr-timeline i a,           #twtr-widget-1 .twtr-bd p {            color: #3B3B3B !important;          }          #twtr-widget-1 .twtr-new-results,           #twtr-widget-1 .twtr-results-inner,           #twtr-widget-1 .twtr-timeline {            background: #F7FFFB !important;          }</style></head>

<body class="page page-id-1256 page-child parent-pageid-149 page-template-default logged-in admin-bar">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="http://linkedscience.org/" title="LinkedScience.org" rel="home">LinkedScience.org</a>
					</span>
				</div>
				<div id="site-description">interconnecting scientific assets!</div>

										<img src="./Amazon–health_files/linkedscience.png" width="940" height="198" alt="">
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="http://linkedscience.org/?page_id=1256&preview=true#content" title="Skip to content">Skip to content</a></div>
								<div class="menu"><ul><li><a href="http://linkedscience.org/" title="Home">Home</a></li><li class="page_item page-item-87"><a href="http://linkedscience.org/events/">Events</a><ul class="children"><li class="page_item page-item-386"><a href="http://linkedscience.org/events/gibda2012/">GIBDA2012</a></li><li class="page_item page-item-69"><a href="http://linkedscience.org/events/lisc2011/">LISC2011</a></li><li class="page_item page-item-585"><a href="http://linkedscience.org/events/lisc2012/">LISC2012</a></li><li class="page_item page-item-802"><a href="http://linkedscience.org/events/lodr4ls/">LODR4LS</a></li><li class="page_item page-item-101"><a href="http://linkedscience.org/events/lssolo11/">LS@SOLO11</a></li><li class="page_item page-item-690"><a href="http://linkedscience.org/events/tolsci2012/">TOLSCI2012</a></li></ul></li><li class="page_item page-item-99"><a href="http://linkedscience.org/publications/">Publications</a></li><li class="page_item page-item-164 current_page_ancestor"><a href="http://linkedscience.org/tools/">Tools</a><ul class="children"><li class="page_item page-item-149 current_page_ancestor current_page_parent"><a href="http://linkedscience.org/tools/sparql-package-for-r/">SPARQL Package for R</a><ul class="children"><li class="page_item page-item-854"><a href="http://linkedscience.org/tools/sparql-package-for-r/sparql-package-for-r-gephi-movie-star-graph-visualization-tutorial/">SPARQL Package for R / Gephi – Movie star graph visualization Tutorial</a></li><li class="page_item page-item-731"><a href="http://linkedscience.org/tools/sparql-package-for-r/linked-open-piracy-tutorial/">SPARQL Package for R – Linked Open Piracy Tutorial</a></li><li class="page_item page-item-151"><a href="http://linkedscience.org/tools/sparql-package-for-r/tutorial-on-sparql-package-for-r/">Tutorial part I – Using the SPARQL Package in R to handle Spatial Linked Data</a></li><li class="page_item page-item-220"><a href="http://linkedscience.org/tools/sparql-package-for-r/tutorial-part-ii-calculating-deforestation-per-state/">Tutorial part II – Calculating Deforestation per State</a></li></ul></li></ul></li><li class="page_item page-item-109"><a href="http://linkedscience.org/vocabularies/">Vocabularies</a></li><li class="page_item page-item-263"><a href="http://linkedscience.org/data/">Data</a><ul class="children"><li class="page_item page-item-265"><a href="http://linkedscience.org/data/linked-brazilian-amazon-rainforest/">Linked Brazilian Amazon Rainforest</a></li><li class="page_item page-item-347"><a href="http://linkedscience.org/data/linked-haiti/">Linked Haiti</a></li><li class="page_item page-item-476"><a href="http://linkedscience.org/data/spatiallinkedscience/">spatial@linkedscience</a></li></ul></li><li class="page_item page-item-574"><a href="http://linkedscience.org/projects/">Projects</a><ul class="children"><li class="page_item page-item-576"><a href="http://linkedscience.org/projects/triangle-of-sustainability/">Triangle of Sustainability</a></li></ul></li><li class="page_item page-item-682"><a href="http://linkedscience.org/tutorials/">Tutorials</a><ul class="children"><li class="page_item page-item-1184"><a href="http://linkedscience.org/tutorials/exploring-the-linked-brazilian-amazon-rainforest-data/">Exploring the Linked Brazilian Amazon Rainforest Data</a></li><li class="page_item page-item-1187"><a href="http://linkedscience.org/tutorials/linked-open-piracy-tutorial/">Linked Open Piracy Tutorial</a></li><li class="page_item page-item-1189"><a href="http://linkedscience.org/tutorials/movie-star-graph-visualization-tutorial/">Movie star graph visualization Tutorial</a></li><li class="page_item page-item-897"><a href="http://linkedscience.org/tutorials/tutorial-using-sparql-on-lodum-data/">Tutorial: Using SPARQL on LODUM Data</a></li></ul></li><li class="page_item page-item-44"><a href="http://linkedscience.org/spatial/">Spatial</a></li><li class="page_item page-item-1195"><a href="http://linkedscience.org/jobs/">Jobs</a><ul class="children"><li class="page_item page-item-1198"><a href="http://linkedscience.org/jobs/linked-data-for-escience-services-life-project-2-positions/">Linked Data for eScience Services (LIFE) project: 2 positions</a></li></ul></li><li class="page_item page-item-211"><a href="http://linkedscience.org/about/">About</a></li></ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="post-1256" class="post-1256 page type-page status-draft hentry">
											<h1 class="entry-title">Amazon – health data</h1>
					
					<div class="entry-content">
						<p>This tutorial reads the pixel based deforestation data for the Amazon region and computes the area weighted deforestation per municipality. This data is linked with data provided by <a href="http://www.ibge.gov.br/english/" target="_blank">IBGE</a>&nbsp;reporting the number of deaths for a set of given reasons for several years. To avoid distortions of these numbers due to the different population sizes, the population weighted average is calculated and used to compute correlation values.</p>
<p>The data has been composed as linked data by&nbsp;Jim Jones (jim.jones@uni-muenster.de), the R-script is provided by <a href="http://ifgi.uni-muenster.de/graeler" target="_blank">Benedikt Gräler</a> (ben.graeler@uni-muenster.de).</p>
<p>Load neccesary libraries:</p>
<pre>library(SPARQL) # version &gt; 1.9
library(spacetime)
library(lattice)</pre>
<p>The data is available online at the following endpoint</p>
<pre># setting the endpoint
endpoint &lt;- "http://spatial.linkedscience.org/sparql"</pre>
<p>The deforestation data is provided pixel based as DEFOR_YEAR. Additionally, the area overlap between pixels and municipalities is provided as triples. This allows to compute the area deforested per municipality within the SPARQL-query as follows:</p>
<pre># defining a first query
q &lt;- "PREFIX amazon: &lt;http://spatial.linkedscience.org/context/amazon/&gt;
      PREFIX tisc: &lt;http://observedchange.com/tisc/ns#&gt;
      PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;
      SELECT DISTINCT ?muni ?aka&nbsp;
        (SUM (?overlapArea) AS ?area)
        (SUM (?defor2002 * ?overlapArea) AS ?def02)
        (SUM (?defor2003 * ?overlapArea) AS ?def03)
        (SUM (?defor2004 * ?overlapArea) AS ?def04)
        (SUM (?defor2005 * ?overlapArea) AS ?def05)
        (SUM (?defor2006 * ?overlapArea) AS ?def06)
        (SUM (?defor2007 * ?overlapArea) AS ?def07)
        (SUM (?defor2008 * ?overlapArea) AS ?def08)
      WHERE&nbsp;{
        ?cell amazon:DEFOR_2002 ?defor2002 .
        ?cell amazon:DEFOR_2003 ?defor2003 .
        ?cell amazon:DEFOR_2004 ?defor2004 .
        ?cell amazon:DEFOR_2005 ?defor2005 .
        ?cell amazon:DEFOR_2006 ?defor2006 .
        ?cell amazon:DEFOR_2007 ?defor2007 .
        ?cell amazon:DEFOR_2008 ?defor2008 .
        ?overlapObject tisc:partialOverlapFrom ?cell .
        ?overlapObject tisc:partialOverlapTo ?muni .
        ?overlapObject tisc:partialOverlapArea ?overlapArea .
        ?aka owl:sameAs ?muni .
      } GROUP BY ?muni ?aka"
ns &lt;- c("amazon","http://spatial.linkedscience.org/context/amazon/")
muniDefor &lt;- SPARQL(endpoint, q, ns=ns, extra=list(output="csv"), format="csv")$result</pre>
<p>Note, that the variable “?aka” is necessary as the &nbsp;municipalities’ identifiers change between a six and seven digit code depending on the data source. The relation is modeled as an “sameAs”. The structure of the retrieved data can be investigated with:</p>
<pre>str(muniDefor)</pre>
<p>returning</p>
<pre>'data.frame': 887 obs. of 10 variables:
$ muni : Factor w/ 887 levels "amazon:BRAZIL_MUNICIPALITY_1100015",..: 268 416 725 783 410 257 824 433 760 755 ...
$ aka : Factor w/ 887 levels "amazon:BRAZIL_MUNICIPALITY_110001",..: 268 416 725 783 410 257 824 433 760 755 ...
$ area : num 1397 774 7487 1339 10036 ...
$ def02: num 21.32 1.02 1.91 18.51 3.28 ...
$ def03: num 27.393 1.6925 0.0966 11.2062 2.2746 ...
$ def04: num 31.2351 1.8865 0.0306 6.1923 0.6461 ...
$ def05: num 24.703 0.136 1.03 10.591 8.371 ...
$ def06: num 1.8204 0.0909 0.0323 2.729 0.1924 ...
$ def07: num 10.895 1.446 0.457 0.775 0.983 ...
$ def08: num 16.864 0.518 1.282 1.706 0.904 ...</pre>
<p>As we are interested in the geometries of the municipalities as well, we retrieve their polygons’ coordinates through:</p>
<pre># query the municipalties' geometries
muniDefor$geometry &lt;- as.character(1:nrow(muniDefor))
for(i in 1:nrow(muniDefor)) {
  q_muni &lt;- paste("PREFIX amazon: &lt;http://spatial.linkedscience.org/context/amazon/&gt;
                   PREFIX tisc: &lt;http://observedchange.com/tisc/ns#&gt;
                   SELECT ?geom where { ",muniDefor$muni[i]," tisc:geometry ?geom }",sep="")
  muniDefor$geometry[i] &lt;- SPARQL(endpoint, q_muni, extra=list(output="csv"), format="csv")$result
}</pre>
<p>The data is returned as a factor, for further use we coerce the coordinates to characters and construct polygons from them.</p>
<pre>muniDefor$geometry &lt;- lapply(muniDefor$geometry, as.character) 

# construct polygons
allPolys &lt;- NULL
for ( i in 1:nrow(muniDefor)) {
  if(i%%100 == 0) cat(i,"\n") # show progress
  tmpStr &lt;- muniDefor$geometry[[i]]
  tmpPoly &lt;- NULL
  for(j in 1:length(tmpStr)) {
  &nbsp; tmpPoly &lt;- append(tmpPoly, Polygon(matrix(unlist(lapply(strsplit(strsplit(tmpStr[j],";")[[1]],","),as.numeric)), ncol=2,byrow=T)))
  }
  allPolys &lt;- append(allPolys, Polygons(tmpPoly, ID=i))
}

# create SpatialPolygons object
spPoly &lt;- SpatialPolygons(allPolys, proj4string=CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"))</pre>
<p>To be able to treat the data easily, we construct a Spatio-Temporal Full Data Frame (STFDF) from the package “spacetime”, add the municipalities names and the deforestation values for the provided years:</p>
<pre># creating the STFDF
amazon &lt;- STFDF(sp=spPoly,time=as.POSIXct(c("2002-01-01","2003-01-01","2004-01-01",
                                            "2005-01-01","2006-01-01","2007-01-01",
                                            "2008-01-01")),
                data=data.frame(defor=numeric(length(spPoly)*7)))

# adding municipality names, aka, and area to sp slot
amazon@sp &lt;- SpatialPolygonsDataFrame(amazon@sp, muniDefor[1:3])

str(amazon@sp@data)</pre>
<p>returning</p>
<pre>'data.frame': 887 obs. of 3 variables:
$ muni: Factor w/ 887 levels "amazon:BRAZIL_MUNICIPALITY_1100015",..: 268 416 725 783 410 257 824 433 760 755 ...
$ aka : Factor w/ 887 levels "amazon:BRAZIL_MUNICIPALITY_110001",..: 268 416 725 783 410 257 824 433 760 755 ...
$ area: num 1397 774 7487 1339 10036 ...</pre>
<p>The deforestation data is added to the STFDF’s data slot</p>
<pre># adding deforestation values for 7 years
for(i in 1:7) {
  amazon@data$defor[((i-1)*length(amazon@sp)+1):(i*length(amazon@sp))] &lt;- muniDefor[[i+3]]
}

str(amazon@data)</pre>
<p>returning</p>
<pre>'data.frame': 6209 obs. of 1 variable:
$ defor: num 21.32 1.02 1.91 18.51 3.28 ...</pre>
<p>A plot of the STFDF can be produced by (takes some time due to the large number of detailed polygons)</p>
<pre>stplot(amazon[,2:3])</pre>
<p><a href="http://linkedscience.org/wp-content/uploads/2012/11/stplot_defor.png"><img src="./Amazon–health_files/stplot_defor-300x150.png" alt="" title="stplot_defor" class="alignnone size-medium wp-image-1263" height="150" width="300"></a></p>
<p>In the following, the addtional data on deaths per reason, municipality and year is retrieved:</p>
<pre># retrieving additional data by municipality
deathData &lt;- NULL&nbsp;
populData &lt;- NULL
for (aka in amazon@sp$aka) {
  tmp &lt;- paste("PREFIX amazon: &lt;http://spatial.linkedscience.org/context/amazon/&gt;
                PREFIX dbpedia: &lt;http://www.dbpedia.org/resource/&gt;&nbsp;                 PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SELECT ?deaths ?reason ?year ?popul where { \n",
                aka, " amazon:hasObservation ?obs .
                ?obs amazon:observationType dbpedia:Death .
                ?obs amazon:amountProduced ?deaths .
                ?obs amazon:isAbout ?reason .
                ?obs amazon:year ?year . \n",
                aka, " amazon:hasObservation ?obsPop .
                ?obsPop amazon:observationType dbpedia:Population .
                ?obsPop amazon:year ?year.
                ?obsPop amazon:population ?popul . }", sep="")
  tmpRes &lt;- SPARQL(endpoint, tmp, ns=c("dbpedia", "http://www.dbpedia.org/resource/"), extra=list(output="csv"), format="csv")$result
  tmpDRes &lt;- cbind(rep(aka,nrow(tmpRes)),tmpRes[,1:3])
  deathData &lt;- rbind(deathData, tmpDRes)
  tmpPRes &lt;- cbind(rep(aka,5),tmpRes[(1:5)*30,c(4,3)])
  populData &lt;- rbind(populData, tmpPRes)
}
colnames(deathData) &lt;- c("aka","deaths","reason","year")
colnames(populData) &lt;- c("aka","popul","year")
str(deathData)</pre>
<p>To combine all the data, we add the newly retrieved death and population data to the STFDF:</p>
<pre> # deaths
for (reason in levels(deathData$reason)) {
  res &lt;- rep(NA,nrow(amazon@data))
  uniqueYears &lt;- unique(deathData$year)
  uniqueYears &lt;- uniqueYears[which(uniqueYears %in% c("2002","2003","2004","2005","2006","2007","2008") )]
  for(year in uniqueYears) {
    sel &lt;- deathData$year==year &amp; deathData$reason==reason
    ids &lt;- match(amazon@sp$aka, deathData[sel,]$aka)
    tId &lt;- which(c("2002","2003","2004","2005","2006","2007","2008") %in% year)
    res[((tId-1)*length(amazon@sp)+1):(tId*length(amazon@sp))] &lt;- deathData[sel,][ids,]$deaths
  }
  amazon@data[[reason]] &lt;- res 
  rm(res)
}

# droping the prefix
colnames(amazon@data)[-1] &lt;- lapply(colnames(amazon@data)[-1], function(x) substr(x,9,nchar(x)))

# adding the population data
populLongTab &lt;- NULL
for(year in 2002:2008) {
  sel &lt;- populData$year == year
  if(sum(sel,na.rm=T)==0)
    res &lt;- rep(NA,length(amazon@sp))
  else
    res &lt;- populData[sel,2]
  populLongTab &lt;- c(populLongTab,res)
}
amazon@data[["Population"]] &lt;- populLongTab
rm(populLongTab)
summary(amazon@data)</pre>
<p>The entire structure of the STFDF can be inspected by</p>
<pre>str(amazon@data)</pre>
<p>As the data is only complete for a subset of years, we temporally subset the STFDF and use only years 2005, 2006 and 2007:</p>
<pre>subAmazon &lt;- amazon[,4:6] 
str(subAmazon@data)</pre>
<p>returning</p>
<pre tabindex="0">'data.frame':	2661 obs. of  32 variables:
 $ defor                       : num  24.703 0.136 1.03 10.591 8.371 ...
 $ Blood_diseases              : int  1 0 0 0 0 0 0 0 0 0 ...
 $ Childbirth                  : int  1 0 0 0 0 1 0 0 0 0 ...
 $ Chromosome_abnormality      : int  1 0 0 0 0 0 0 0 0 1 ...
 $ Circulatory_system          : int  2 1 3 4 0 3 1 1 0 17 ...
 $ Congenital_disorder         : int  1 0 0 0 0 0 0 0 0 1 ...
 $ Connective_tissue           : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Deformities                 : int  1 0 0 0 0 0 0 0 0 1 ...
 $ Endocrine_system            : int  0 0 0 1 0 1 0 0 0 3 ...
 $ Exame_laboratorial          : int  1 0 0 0 0 0 0 0 0 1 ...
 $ External_cause              : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Eye                         : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Genetic_disorder            : int  1 0 0 0 0 0 0 0 0 1 ...
 $ Genitourinary_system        : int  2 0 1 2 0 0 0 0 0 7 ...
 $ Human_gastrointestinal_tract: int  1 0 4 0 0 3 1 0 0 4 ...
 $ Human_musculoskeletal_system: int  0 0 0 0 0 0 0 0 0 0 ...
 $ Infectious_disease          : int  3 0 2 1 1 3 0 1 0 15 ...
 $ Lesion                      : int  0 0 1 1 0 1 2 0 0 2 ...
 $ Mastoiditis                 : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Medical_test                : int  1 0 0 0 0 0 0 0 0 1 ...
 $ Mental_disorder             : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Neoplasm                    : int  2 1 2 0 0 1 1 0 0 2 ...
 $ Nervous_system              : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Nosocomial_infection        : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Perinatalperiode            : int  5 1 2 1 0 2 1 0 0 5 ...
 $ Poison                      : int  0 0 1 1 0 1 2 0 0 2 ...
 $ Pregnancy                   : int  1 0 0 0 0 1 0 0 0 0 ...
 $ Puerpera                    : int  1 0 0 0 0 1 0 0 0 0 ...
 $ Respiratory_system          : int  1 0 7 1 0 1 0 0 0 11 ...
 $ Skin                        : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Subcutaneous_tissue         : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Population                  : int  23587 3878 14849 3704 4325 13018 1792 9441 12696 26938 ...</pre>
<p>Now, we can investigate relationships between the collected data by Kendall’s rank correlation coefficient tau:</p>
<pre># correlation of deforestation rate and deaths/population
corLine &lt;- cor(subAmazon@data[,1]/subAmazon@sp$area, cbind(subAmazon@data[,2:31]/subAmazon@data[,32],subAmazon@data[,32,drop=F]),
               use="pairwise", method="kendall")</pre>
<p>The following plot gives insight in the dependence structure:</p>
<pre>barchart(corLine[,], origin=0,col="darkgrey", main="Kendall's tau for defor. rates and rel. deaths in Amazonian Municipalities for 2005, 2006 and 2007",
         xlab="Kendall's tau coorelation coefficient")</pre>
<p><a href="http://linkedscience.org/wp-content/uploads/2012/11/barchart.png"><img src="./Amazon–health_files/barchart-300x150.png" alt="" title="barchart" class="alignnone size-medium wp-image-1264" height="150" width="300"></a></p>
<pre>colnames(corLine)[which.max(corLine[-31])]</pre>
<p>The largest Kendall’s tau values are found for “Population” and death by “Infectious_disease”. Both coefficents are found to be significant based on the following tests:</p>
<pre># test correlation for population
cor.test(subAmazon@data[,1]/subAmazon@sp$area, subAmazon@data[,32], method="kendall",use="pairwise.complete") # p&lt; 0.01

# test correlation for Infectious_disease
cor.test(subAmazon@data[,1]/subAmazon@sp$area, subAmazon@data[,17]/subAmazon@data[,32], method="kendall",use="pairwise.complete") # p&lt; 0.01</pre>
<p>To further investigate and plot the data, we add the relative variables and plot the scatter:</p>
<pre># adding relative variables
subAmazon@data[["rel_Infect_dis"]] &lt;- subAmazon@data[["Infectious_disease"]]/subAmazon@data[,32]
subAmazon@data[["Infect_dis_per_25"]] &lt;- subAmazon@data[["Infectious_disease"]]/subAmazon@data[,32]*25
subAmazon@data[["rel_defor"]] &lt;- subAmazon@data[["defor"]]/subAmazon@sp$area 

# look at the scatter
plot(cbind(subAmazon@data[,"rel_defor",drop=F],subAmazon@data[,"rel_Infect_dis"]))</pre>
<p><a href="./Amazon–health_files/scatter_plot.png"><img src="./Amazon–health_files/scatter_plot.png" alt="" title="scatter_plot" class="alignnone size-full wp-image-1265" height="400" width="400"></a></p>
<p>Maps can be plotted by</p>
<pre>stplot(subAmazon[,1:2,"rel_Infect_dis"],col.regions=bpy.colors(), main="relative number of deaths by \"infectious disease\"")</pre>
<p><a href="http://linkedscience.org/wp-content/uploads/2012/11/stplot_inf_dis.png"><img src="./Amazon–health_files/stplot_inf_dis-300x150.png" alt="" title="stplot_inf_dis" class="alignnone size-medium wp-image-1266" height="150" width="300"></a></p>
<pre>spplot(subAmazon[,2],c("Infect_dis_per_25","rel_defor"),col.regions=bpy.colors(), main="deaths/25 caused by \"infectious disease\" vs deforestation rate in 2006")</pre>
<p><a href="http://linkedscience.org/wp-content/uploads/2012/11/spplot_rel.png"><img src="./Amazon–health_files/spplot_rel-300x150.png" alt="" title="spplot_rel" class="alignnone size-medium wp-image-1267" height="150" width="300"></a></p>
</div><!-- .entry-content -->
				</div><!-- #post-## -->

				
		</div><!-- #container -->